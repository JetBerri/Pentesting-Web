# WFUZZ

<img src="https://github.com/xmendez/wfuzz/blob/master/docs/_static/logo/wfuzz_letters.svg" width="500">

Wfuzz es una herramienta cuya función principal es hacer fuzzing, como lo indica su nombre.

# ¿Qué es el Fuzzing?

El "fuzzing" es una técnica de prueba de seguridad que implica enviar datos aleatorios a una aplicación o sistema, para el descubrimiento de cosas ocultas, a nivel web podrian ser directorios, subdominos o ficheros que se alojen en el servidor web.

# Encontrar directorios ocultos

Para fuzzear por directorios con wfuzz usaremos el siguiente comando:

```
❯ wfuzz -c -w usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://dominio.com/FUZZ
```

- -c -> Este parámetro lo que va a hacer es darle color al output de la herramienta
- -w -> Con este parámetro le indicamos el diccionario que va a usar para el fuzzing
- FUZZ -> La palabra "FUZZ" nos sirve para indicarle al programa donde queremos que se coloque cada línea del diccionario

El resultado se vería así:

```
❯ wfuzz -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt https://google.com/FUZZ
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: https://google.com/FUZZ
Total requests: 220546

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                
=====================================================================

000000015:   301        6 L      14 W       227 Ch      "privacy"                                                                                                              
000000001:   404        11 L     72 W       1562 Ch     "index"                                                                                                                
000000036:   404        11 L     72 W       1559 Ch     "06"                                                                                                                   
000000035:   404        11 L     72 W       1559 Ch     "08"                                                                                                                   
000000031:   404        11 L     72 W       1558 Ch     "1"                                                                                                                    
000000003:   404        11 L     72 W       1565 Ch     "download"                                                                                                             
000000037:   404        11 L     72 W       1558 Ch     "2"                                                                                                                    
000000038:   404        11 L     72 W       1559 Ch     "07"                                                                                                                   
000000034:   404        11 L     72 W       1559 Ch     "01"                                                                                                                   
000000007:   404        11 L     72 W       1563 Ch     "serial"                                                                                                               
000000033:   404        11 L     72 W       1562 Ch     "links"                                                                                                                
000000027:   301        6 L      14 W       224 Ch      "2005"                                                                                                                 
000000024:   301        6 L      14 W       224 Ch      "home"                                                                                                                 
000000029:   404        11 L     72 W       1564 Ch     "sitemap"                                                                                                              
000000030:   404        11 L     72 W       1565 Ch     "archives"                                                                                                             
000000022:   404        11 L     72 W       1560 Ch     "faq"                                                                                                                  
000000026:   404        11 L     72 W       1564 Ch     "default"                                                                                                              
000000028:   404        11 L     72 W       1565 Ch     "products"

```

Si nos fijamos, hay distintos campos que tienen diferentes contenidos, les explicaré que dice cada campo:

- **Response**: Muestra el codigo de estado que obtuvo del lado del servidor al probar el payload.
- **Lines**: Muestra el número de líneas en la respuesta HTTP.
- **Word**: Muestra el número de palabras en la respuesta HTTP.
- **Chars**: Muestra el número de caracteres en la respuesta HTTP. 
- **Payload**: Muestra la línea del diccionario que probo.

# Métodos de filtrados

## Ocultando ciertos resultados

Como vimos en el output del comando anterior, habian varias resultados que devolvian un [codigo de estado 404](https://github.com/0nyxMind/Pentesting-Web/blob/main/Conceptos/Codigos%20de%20estados%20http.md), supongamos que queremos ocultar esos resultados, para eso usaremos el parametro 

- **--hc=404**

Este parámetro hace referencia a "Hide Code", que en español significa "Ocultar código"

```
❯ wfuzz -c --hc=404 -w usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://dominio.com/FUZZ
```

El resultado se vería así:

```
❯ wfuzz -c --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt https://google.com/FUZZ
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: https://google.com/FUZZ
Total requests: 220546

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                
=====================================================================

000000015:   301        6 L      14 W       227 Ch      "privacy"                                                                                                              
000000027:   301        6 L      14 W       224 Ch      "2005"                                                                                                                 
000000024:   301        6 L      14 W       224 Ch      "home"                                                                                                                 
000000018:   301        6 L      14 W       224 Ch      "blog"                                                                                                                 
000000012:   301        6 L      14 W       225 Ch      "about"                                                                                                                
000000013:   301        6 L      14 W       226 Ch      "search"                                                                                                               
000000011:   301        6 L      14 W       227 Ch      "contact"                                                                                                              
000000004:   301        6 L      14 W       224 Ch      "2006"                                                                                                                 
000000002:   301        6 L      14 W       226 Ch      "images"                                                                                                               
000000005:   302        0 L      0 W        0 Ch        "news"                                                                                                                 
000000076:   301        6 L      14 W       224 Ch      "docs"                                                                                                                 
000000074:   301        6 L      14 W       224 Ch      "2004"                                                                                                                 
000000068:   301        6 L      14 W       228 Ch      "services"  
```

En caso de que queramos ocultar más de un código de estado, lo debemos especificar separado por una ",".

- **--hc=404,301**

Este no es el único modo de filtrados que tiene la herramienta, también podemos ocultar los resultados ya sean por las líneas, palabras o caracteres.

- **--hl** -> Hide Lines
- **--hw** -> Hide Words
- **--hh** -> Hide Chars

## Mostrando ciertos resultados

Supongamos que ahora no queremos ocultar ciertos códigos de estados, solo mostrar los que a nosotros nos interesen, para eso vamos a hacer uso del parámetro 

- **--sc**

Este parámetro hace referencia a "Show Code", que en español significa "Mostrar código"

```
❯ wfuzz -c --sc=200 -w usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://dominio.com/FUZZ
```

El resultado se vería así:

```
❯ wfuzz -c --sc=200 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt https://google.com/FUZZ
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: https://google.com/FUZZ
Total requests: 220546

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                
=====================================================================

000000015:   200        1842 L   4039 W     87536 Ch    "privacy"                                                                                                              
000000012:   200        2173 L   4609 W     100361 Ch   "about"                                                                                                                
000000013:   200        18 L     408 W      16090 Ch    "search"                                                                                                               
000000011:   200        1169 L   2613 W     51884 Ch    "contact"                                                                                                              
000000002:   200        17 L     411 W      15977 Ch    "images"                                                                                                               
000000018:   200        7763 L   12677 W    247262 Ch   "blog"                                                                                                                 
000000027:   200        146 L    2636 W     264912 Ch   "2005"
```

Al igual que antes, también podemos mostrar los resultados ya sean por las líneas, palabras o caracteres.

- **--sl** -> Show Lines
- **--sw** -> Show Word
- **--sh** -> Show Chars

# Evitar los follow redirects

Supongamos que al hacer el fuzzing tenemos varios códigos de estado "301", los cuales no sabemos si apuntan a un recurso que devuelve un 200 o un 404, para saberlo podemos usar el parámetro

- **-L**

Este parámetro evitará los códigos de estado 301, ya que les hará un Follow Redirect.

# Crear listas

Una opción bastante buena que tiene wfuzz es la de poder crear listas, estas listas las podemos usar por ejemplo para encontrar distintos archivos con distintas extensiones en un servidor web.

Esto se hace con el parámetro

- **-z list**

Supongamos que queremos buscar por extensiones .php, .html y .txt. El comando a ejecutar sería el siguiente.

```
❯ wfuzz -c -L --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -z list,php-html-txt https://google.com/FUZZ.FUZ2Z
```

Si se fijan, ahora agregue la palabra "FUZ2Z", en esta palabra se sustituirán las extensiones.

```
❯ wfuzz -c -L --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -z list,php-html-txt https://google.com/FUZZ.FUZ2Z
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: https://google.com/FUZZ.FUZ2Z
Total requests: 661638

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                
=====================================================================

000000044:   200        11 L     39 W       1377 Ch     "privacy - html"                                                                                                       
000000035:   200        2173 L   4609 W     100361 Ch   "about - html"                                                                                                         
000000002:   200        16 L     359 W      13952 Ch    "index - html"                                                                                                         
000000086:   200        5731 L   11173 W    274542 Ch   "sitemap - html"                                                                                                       
000000167:   200        18 L     408 W      16139 Ch    "3 - html"                                                                                                             
000000170:   200        1153 L   3427 W     48175 Ch    "security - html"                                                                                                      
000000236:   200        4149 L   29891 W    907882 Ch   "features - html"                                                                                                      
000000401:   200        0 L      0 W        0 Ch        "blank - html
```

# Fuzzear subdominos

Si queremos descubrir subdominios de un sitio web, debemos usar el parámetro 

- **-H**

El comando a ejecutar sería el siguiente.

```
❯ wfuzz -c --hc=404 -w /usr/share/wordlists/dirb/common.txt -H "Host: FUZZ.google.com" https://google.com
```

```
❯ wfuzz -c --hc=404 -w /usr/share/wordlists/dirb/common.txt -H "Host: FUZZ.google.com" https://google.com
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: https://google.com/
Total requests: 4614

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                
=====================================================================

000000223:   301        6 L      14 W       218 Ch      "about"                                                                                                                
000000247:   302        6 L      14 W       226 Ch      "account"                                                                                                              
000000252:   302        9 L      18 W       338 Ch      "accounts"                                                                                                             
000000224:   301        6 L      14 W       218 Ch      "About"                                                                                                                
000000259:   302        6 L      14 W       235 Ch      "actions"                                                                                                              
000000265:   302        0 L      0 W        0 Ch        "activity"                                                                                                             
000000286:   302        0 L      0 W        0 Ch        "admin"                                                                                                                
000000288:   302        0 L      0 W        0 Ch        "ADMIN"                                                                                                                
000000402:   301        6 L      14 W       240 Ch      "analytics"                                                                                                            
000000381:   301        6 L      14 W       226 Ch      "alerts"                                                                                                               
000000287:   302        0 L      0 W        0 Ch        "Admin"                                                                                                                
000000338:   302        0 L      0 W        0 Ch        "ads"                                                                                                                  
000000429:   301        6 L      14 W       226 Ch      "apis"
```

# Hacer peticiones por POST

En caso de que queramos tramitar las peticiones por el método post, podemos usar el parámetro

- **-X**

Y en caso de que queramos tramitar datos, podemos usar el parámetro

- **-d**

Esto nos puede ser bastante útil para realizar ataques de fuerza bruta, supongamos que en una web al conectarnos envía la petición por POST de la siguiente manera:

```username=admin&password=admin```

El comando a ejecutar seria el siguiente:

```
❯ wfuzz -c -X POST -w /usr/share/seclists/Usernames/Names/names.txt --sc 200 -d "username=FUZZ&password=admin" http://example.com/login.php
```

# Agregar segundo diccionario

Ahora probemos con otro caso, supongamos que también queremos meter un diccionario con contraseñas, aparte del que ya tenemos (el de usuarios)

Para eso usaremos el parámetro

- **-z,file**

El comando a ejecutar sería el siguiente

```
❯ wfuzz -c -z file,/usr/share/seclists/Usernames/Names/names.txt -w /usr/share/wordlists/rockyou.txt --sc 200 -d "username=FUZZ&password=FUZ2Z" http://example.com/login.php
```
