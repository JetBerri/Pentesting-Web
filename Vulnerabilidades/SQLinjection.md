<img src="https://raw.githubusercontent.com/0nyxMind/Pentesting-Web/main/Vulnerabilidades/Imagenes-Vulns/sqlinjection-banner.jpg">

# ¿Qué es SQL Injection?

AQL Injection es una vulnerabilidad web que permite a un atacante interferir con las consultas que una aplicación realiza a su base de datos, gracias a esta vulnerabilidad un atacante puede llegar a ver datos que normalmente no son publicos para terceros. Esto puede incluir datos pertenecientes a otros usuarios o cualquier otro dato sobre la aplicación.

Aquí estarán las resoluciones de los laboratorios de [PortSwigger](https://portswigger.net/web-security/sql-injection)

# 1. Lab: Vulnerability in WHERE clause allowing retrieval of hidden data

> https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data

Al entrar el laboratorio veremos esto:
<img src="https://raw.githubusercontent.com/0nyxMind/Pentesting-Web/main/Vulnerabilidades/Imagenes-Vulns/lab1-sqli.png">

Tenemos varios botones, que al hacerles clic modifican la URL, vamos a darle por ejemplo a ```"Gifts"```

Luego de hacerlo, en la URL se agregara ```/filter?category=Gifts```

Podemos pensar que por detrás la aplicación web está realizando la siguiente consulta a la base de datos:

```SELECT * FROM products WHERE category = 'Gifts' AND released = 1```

Esta query SQL, lo que está haciendo es solicitar todos los datos, dentro de la tabla ```products```, mientras que con el ```WHERE``` filtra por la columna ```Gifts```, y con ```AND released = 1``` se seleccionarán los productos que ya han sido lanzados al mercado.

Para poder explotar esto, podemos intentar inyectar nuestra query SQL en el campo "Gifts", poniendo ```' or 1=1--```

Con la primer ```'``` lo que hacemos es cerrar la primer query, es decir, en vez de estar poniendo 

```SELECT * FROM products WHERE category = 'Gifts'```

Estamos poniendo 

```SELECT * FROM products WHERE category = 'Gifts' or 1=1--'```

luego con el ```or 1=1``` estamos haciendo una comparación que es igual a ```True```, ya que 1 es igual a 1, y para finalizar, con los 2 guiones ```--``` estamos comentando el resto de la query.

<img src="https://raw.githubusercontent.com/0nyxMind/Pentesting-Web/main/Vulnerabilidades/Imagenes-Vulns/sqli1.png">

# 2. Lab: Vulnerability allowing login bypass

Al entrar a este laboratorio, veremos que hay un apartado llamado ```My account```, el cual al hacerle clic nos redirige a un formulario de inicio de sesión

<img src="https://raw.githubusercontent.com/0nyxMind/Pentesting-Web/main/Vulnerabilidades/Imagenes-Vulns/lab2-sqli.png">

Supongamos que el servidor tramita esta query sql

```SELECT * FROM users WHERE username = 'username' AND password = 'password'```

Podemos bypassear este formulario de inicio de sesión haciendo uso de la anterior query

-  ```'or 1=1--```

Ya que si ponemos como usuario ```'or 1=1--``` la query que enviara el servidor a la base de datos será la siguiente

```SELECT * FROM users WHERE username = '' or 1=1-- '```

Esto sera ignorado ➜ AND password = 'password', gracias a los ```--```

<img src="https://raw.githubusercontent.com/0nyxMind/Pentesting-Web/main/Vulnerabilidades/Imagenes-Vulns/lab2-sqli-result.png">

# 3. Lab: UNION attack, determining the number of columns

## ¿Qué son los UNION Attack?

Cuando una aplicación es vulnerable a la inyección SQL y los resultados de la consulta se devuelven dentro de las respuestas de la aplicación, el UNION es la palabra clave se puede utilizar para recuperar datos de otras tablas dentro de la base de datos.
